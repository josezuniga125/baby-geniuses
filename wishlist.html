<!doctype html>

<html>
<head>
    <!-- Load style sheets -->
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.css">
    <link rel="stylesheet" href="wishlist.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
   
    <script src="wishlist.js"></script>

</head>

   
<body>



<div class="container">
  <div class="row">

    <div class="col-md-2" id="firstColumn">
       <img draggable="false" id="wishListPiggy" src="piggy.jpg" onclick="window.location.href='mainPage.html'">
       <img draggable="false" class = "dropZone" id="trashCan" src="trashcan.png" style="height: auto; width: 100%; object-fit: contain">

       <!-- HTML Code for the trashcan modal -->
       <div id="myTrashModal" class="modal">
      <!-- Modal content -->
        <div class="modal-content">
          <div class="modal-header">
            <span class="trashClose">&times;</span>
              <h2>This item costs $5. Do you want to subtract this amount from your total?</h2>
          </div>
          <div class="trashModal-body">
            <button type="button" class = "btn btn-default" id = "yesButton" onclick="deductFromTotal()">Yes </button>
            <button type="button" class = "btn btn-default" id = "noButton" onclick="hideTrashModal()">No </button>
          </div>
       
        </div>
      </div>

    </div>

    <div class="col-md-8" id="mainColumn">

      <div class="container" id="wishlistContainer">
          <img draggable="true" id="basketball" src="wishlist-icons/basketball.png">
          <img draggable="true" id="teddyBear" src="wishlist-icons/teddy-bear.png">
          <img draggable="true" id="rollerSkates" src="wishlist-icons/skates.png">
          <img draggable="false" id="wishListThoughtBubble" src = "wishListThoughtBubble.jpg">
      </div>

      <div class="totalAmount" id="total">Total: $5.00</script></div>

    </div>

    <div class="col-md-2" id="lastColumn">
      <img draggable="false" id="wishListPlusSign" src = "plusSign.gif" style="height: auto; width: 100%; object-fit: contain">

      <!-- Code for drop down box for adding item -->
      <div id="myModal" class="modal">
      <!-- Modal content -->
        <div class="modal-content">
          <div class="modal-header">
            <span class="close">&times;</span>
              <h2>Add Item to Wishlist</h2>
          </div>
          <div class="modal-body">
            
            <table id="modal-body-detail">
              <tr id="modal-name">
                  <td class="modal-detail-name"> Name: </td>
                  <td class="modal-detail-input"><input id="modal-name-input" type="text"></td>
              </tr>
              <tr id="modal-amount">
                  <td class="modal-detail-name"> Amount: </td>
                  <td class="modal-detail-input"><input id="modal-amount-input" type="text"></td>
              </tr>
            </table>
           
            
          </div>
          <div class="modal-footer">
            <button type="button" class = "btn btn-default" id = "confirmButton">Confirm </button>
          </div>
        </div>
      </div>

    </div>


</body>


    <script>

        //Code for dragging items to the trashcan
        var dragged;

        /* events fired on the draggable target */
        document.addEventListener("drag", function( event ) {
          event.dataTransfer.setData("text", event.currentTarget.id);
          //console.log(event.currentTarget.id);
          //console.log("in drag");
        }, false);

        document.addEventListener("dragstart", function( event ) {
            // store a ref. on the dragged elem
            dragged = event.target;
            clone = event.target.cloneNode(true);
            // make it half transparent
            event.target.style.opacity = 0;
        }, false);

        document.addEventListener("dragend", function( event ) {
            // reset the transparency
            event.target.style.opacity = "";
        }, false);

        /* events fired on the drop targets */
        document.addEventListener("dragover", function( event ) {
            // prevent default to allow drop
            event.preventDefault();
        }, false);

        document.addEventListener("dragenter", function( event ) {
            // highlight potential drop target when the draggable element enters it
            if ( event.target.className == "dropZone" ) {
                //event.target.style.background = "lightgrey";
            }

        }, false);

        document.addEventListener("dragleave", function( event ) {
            // reset background of potential drop target when the draggable element leaves it
            if ( event.target.className == "dropZone" ) {
                event.target.style.background = "";
            }
        }, false);

        document.addEventListener("drop", function( event ) {
            // prevent default action (open as link for some elements)
            event.preventDefault();
            // move dragged elem to the selected drop target
            if (event.target.className == "dropZone" ) {
              event.target.style.background = "";
              dragged.parentNode.removeChild( dragged );
                
              trashModal.style.display = "block";

              trashSpan.onclick = function() {
                trashModal.style.display = "none";
              }

              window.onclick = function(event) {
                if (event.target == trashModal) {
                trashModal.style.display = "none";
                }
              }

              trashNoButton.onclick = function() { //isnt working right now. still have to give these functionality. Total has to be modifiable and updated when Yes is pressed. Just a default decrease of 5 dollars should be good
                trashModal.style.display = "none";
              }

            }

        }, false);



        //For the trashCan modal
        //Get the modal
        var trashModal = document.getElementById('myTrashModal');
        // Get the <span> element that closes the modal
        var trashSpan = document.getElementsByClassName("trashClose")[0];

        var trashNoButton = document.getElementById("noButton");
        var trashYesButton = document.getElementById("yesButton");

        function hideTrashModal() {
          trashModal.style.display = "none";
        }

        var totalAmount = document.getElementsByClassName('totalAmount')[0];

        function deductFromTotal() {
          trashModal.style.display = "none";
          if (totalAmount.innerHTML == "TOTAL: $10.00") {
            totalAmount.innerHTML = "TOTAL: $5.00";
            return;
          }
          totalAmount.innerHTML = "TOTAL: $0.00";
        }

        //For the plus sign modal
        // Get the modal
        var modal = document.getElementById('myModal');

        // Get the button that opens the modal
        var btn = document.getElementById("wishListPlusSign");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];

        // When the user clicks the button, open the modal 
        btn.onclick = function() {
            modal.style.display = "block";
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
            modal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }


    </script>




</html>